---
// import { getSanityImageURL, formatMusicPerv } from '../utils/helpers'
import { getSanityImageURL, formatBlogPostDate } from '../utils/helpers.js'
export interface Props {
  music: any;
}
  
const { music } = Astro.props;
---
  <!-- <a href={`${music.slug.current}`}>
                  <div class="relise-text">{music.title}</div>
  </a> -->

  <!-- {music.tracklist.map((track) => {
    return (
      <li key={track._key}>
        <span>{track.number}</span>
        <span>{track.duration}</span>
        {track.manuscript && (
          <a href={`https://cdn.sanity.io/files/2xd7irb9/production/${track.manuscript.asset._ref.replace('file-', '').replace('-pdf', '.pdf')}`} download>
            Download Manuscript
          </a>
        )}
      </li>
    );
  })} -->

  {music.tracklist.map((track) => {
    if (track.manuscript && track.manuscript.asset) {
      const fileRef = track.manuscript.asset._ref.replace('file-', '');
      const lastDashIndex = fileRef.lastIndexOf("-");
      const fileExtension = fileRef.substring(lastDashIndex + 1);
      const formattedFileRef = `${fileRef.substring(0, lastDashIndex)}.${fileExtension}`;
      const fileUrl = `https://cdn.sanity.io/files/2xd7irb9/production/${formattedFileRef}`;
  
      return (


  <div class="file-manager-table-row">
    <div id="w-node-_694f3f70-19c5-1b7b-827a-6cea25fe3635-ca9d863e" class="table-item">
        <div class="table-item-mobile-caption">
            <div class="text-100 medium text-uppercase">Имя</div>
        </div>
        <div class="flex align-center">
            
            <div class="flex align-center">
                <div class="text-200 medium color-neutral-800">{track.number}</div>
            </div>
        </div>
    </div>
    <div id="w-node-_694f3f70-19c5-1b7b-827a-6cea25fe364a-ca9d863e" class="table-item">
        <div class="table-item-mobile-caption">
            <div class="text-100 medium text-uppercase">Тема</div>
        </div>
        <div id="w-node-_694f3f70-19c5-1b7b-827a-6cea25fe364e-ca9d863e" class="text-200">{track.duration}</div>
    </div>
    <div id="w-node-_694f3f70-19c5-1b7b-827a-6cea25fe3650-ca9d863e" class="table-item">
        <div class="table-item-mobile-caption">
            <div class="text-100 medium text-uppercase">Дата задания</div>
        </div>
        <div id="w-node-_694f3f70-19c5-1b7b-827a-6cea25fe3654-ca9d863e" class="text-200">{formatBlogPostDate(track.released)}</div>
    </div>
    <div id="w-node-_694f3f70-19c5-1b7b-827a-6cea25fe3656-ca9d863e" class="table-item">
        <div class="table-item-mobile-caption">
            <div class="text-100 medium text-uppercase">Тип файла</div>
        </div>
        <div id="w-node-_694f3f70-19c5-1b7b-827a-6cea25fe365a-ca9d863e" style=" text-transform: uppercase;" class="text-200">{fileExtension}</div>
    </div>
    <div id="w-node-a61542d2-58a0-9095-449b-3ba12e3a4293-ca9d863e" class="table-item last">
        <div class="table-item-mobile-caption">
            <div class="text-100 medium text-uppercase">Действия</div>
        </div>
        <div class="">
          <a href={fileUrl} target="_blank" download class="btn-secondary small w-button"><span class="line-rounded-icon link-icon-left"><i class='bx bxs-download'></i></span>Скачать</a>
        </div>
       

    </div>
</div>



// <a href={fileUrl} download>
//         <div id="w-node-a61542d2-58a0-9095-449b-3ba12e3a4297-ca9d863e" class="flex align-center">
//             <div class="dashly-custom-icon download-icon mg-right-10px"><i class='bx bxs-download' ></i></div>
//         </div>
//       </a>

        // <li key={track._key}>
        //   <span>{track.number}</span>
        //   <span>{track.duration}</span>
        //   <a href={fileUrl} download>
        //     Download
        //   </a>
        // </li>
      );
    } else {
      return (
        <li key={track._key}>
          <span>{track.number}</span>
          <span>{track.duration}</span>
        </li>
      );
    }
  })}

  <!-- <div class="tracklist">
    <ul>
      {music.tracklist.map((track) => {
        return (
          <li key={track._key}>
            <span class="duration">{track.duration}</span>
            <span class="number">{track.number}</span>
          </li>
        );
      })}
    </ul>
  </div> -->

<!-- {music.tracklist.map((number) => (
{number}))}

{tracklist &&
  tracklist.map((tracklist) => {
    return (
        {tracklist.duration}
        );                  
  })
} -->
